---
title: "Statistical Learning for Data Science Exam"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, error=TRUE)
```

The duration of the exam is 120 minutes. For most exercises you are required to provide R code: write your code in the assigned R code chunk. For some exercises you are required to provide a textual answer: type your answer in the space that follows 

**Your answer**.

In the following R chunk please fill in the required information otherwise the file will not be knitted

```{r, error=FALSE}
matricola <- 123456
#write your name within quotes, i.e. name <- "your name"
name <- "none"
#write your suname within quotes, i.e. name <- "your surname"
surname <- "none"
if (!exists("matricola") | !exists("name") | !exists("surname"))
  stop("Please, insert your information in the first chunk.")
```

```{r, cache=FALSE}
library(SLDS2425)
library(tidyverse)
```

# Exercise 1

## a)

**Your answer**:
```{r}

```


## b) 

**Your answer**:
```{r}

```

## c)

**Your answer**:
```{r}


```

## d) 

**Your answer**:
```{r}


```


## e) 

**Your answer**:

```{r}

  
```


# Exercise 2
A data analyst has processed some data regarding supermarket sales (in dollars) of two categories of pasta, "FreshCutPasta" and "FreshNoodles". The response variable is a dummy variable that takes the value '0' if the sales of "FreshCutPasta" are greater than those of "FreshNoodles" and '1' otherwise. The covariate is categorical and refers to the different ingredients used to make the pasta: 'plain' (wheat) and "whole" (whole wheat). In the chunk below you are given some information regarding the output of the analysis, in particular

  * the summary of a logistic regression model estimated by the analyst. Some entries are purposedly shown as 'NA'
  * the vector with the values of the response variable (the variable containing the values is called `pasta`)
  * the vector with the values of the explanatory variable (the variable containing the values is called `flavour`)

To visualize the summary and get access to the variables containing the values of the residuals and of the explanatory variable *you have to compile the code*.
  
```{r echo=TRUE}
library(SLDS2425)
set.seed(matricola)
obj <- slds.fun(matricola, 1)
pasta <- obj$pasta
flavour <- obj$flavour
```

## (a) 
By using the information included in the summary above, provide the interpretation of the coefficients in the model in terms of the odds ratio (no coding needed, just plain text)

**Your answer**:
The reference category in this logistic regression is `flavour=wheat` so the intercept is telling us what is the change in the odds ratio for when the ingredient is just `wheat`. The coefficient associated to the category `whole wheat` gauges how the odds ratio is changing with respect to the reference category. In particular, if the coefficient for category `whole wheat` is greater than zero then the odds for that category are higher than for the reference category, lower otherwise.


## (b)
By using the information included in the summary of the estimated logistic regression model, state whether it is more likely to sell more `FreshNoodles` than `FreshCutPasta` when the ingredient is just `wheat`


calculate the odds ratio when `flavour=whole grain` (no coding needed, just plain text)

**Your answer**:

## (c)
By using all the available information, estimate the model displayed in the summary. Check whether there are influential observations.

**Your answer**:
```{r echo=TRUE}




```

## (d)
Use the model estimated in the previous point to predict the sales of the two categories of pasta on 12/24/2024. Motivate your answer (just text or text and code).

**Your answer**:



# Exercise 3
"Fiber Bits" is an internet service provider company. The company is concerned about the high attrition rate in the customer base. They want to get an idea on what are the main factors that lead to customer attrition.  

The company has collected around 10000 customer historical data from last three years. We need to build a model that identifies the customers who are most likely to leave, i.e. we need to quantify the chance of attrition for each of the customer. The model will be used on the active customers. To reduce the attrition rate, they have introduced vouchers and other benefits program. The objective is to identify the customers who are most likely to quit in next 2 years and try to retain them by offering free vouchers and benefits. 

Load the data by using the command `data("fiberbits")`. Here a short legend of the variables.

- `active_cust` Active - 1  (Customer Attrition=No)
Not Active â€“ 0 (Customer Attrition=Yes)

- `income`  Estimated monthly income

- `months_on_network` Months on network (Months from the service start day)

- `Num_complaints` Total complaints till now

- `number_plan_changes` Number of times the service plan is changed

- `monthly_bill`  Average monthly bill

- `technical_issues_per_month` Number of technical issues per month

- `Speed_test_result` Percent of (Actual speed/Promised speed)


## (a) 
Run the chunk below (do not modify it). The outputs are contingency tables with the variable `active_cust` on the rows and `Num_complaints` on the columns. Which table would you use to assess whether the variable `Num_complaints` is worth to be included in a regression model with `active_cust` as response variable? Motivate you answer (just plain text)

```{r echo=TRUE}
library(SLDS2425)
data(fiberbits)
slds.fun(matricola, 2, fiberbits)
```


**Your answer**:

## (b) 
Run the chunk below (do not modify it). The output is a confusion matrix (predicted values on the rows, actual values on the columns) obtained from a classifier that was fit to the data. The matrix has been built by using data not used to estimate the model. By looking at the matrix argue about the ability of the classifier to correctly detect customers that quit. Motivate your answer (only text or text and code).

```{r echo=TRUE}
library(SLDS2425)
data(fiberbits)
slds.fun(matricola, 3, fiberbits)
```

**Your answer**:
```{r echo=TRUE}

```

## (c)
Split the data set into a  traning and test data sets. Estimate a statistical model for **the chance of a customer leaving** by using shrinkage methods. Select the best model according to a suitable criteria. 

**Your answer**:
```{r echo=TRUE}

```

## (d)
Build a classifier to identify the customers who are most likely to quit. Compare the performance of the classifier, using suitable metrics, with the classifier considered in point (b). Comment on the results.

**Your answer**:
```{r echo=TRUE}

```


# Session Info

Do not modify the chunk below
```{r}
Sys.info()
#last compiled
date()
#student info
paste(name, surname, "-", matricola, sep=" ")
```
